# HeroesSnapshotDiffer

**HeroesSnapshotDiffer** is a tool to generate snapshots of different versions of Heroes of the Storm's files, as well as generate a [diff](https://en.wikipedia.org/wiki/Diff) and upload the results to Reddit.

## TODO:

- <input type="checkbox" name="TODO6"><label for="TODO6"><b>Better Error Handling and checks.</b></label>
- <input type="checkbox" name="TODO1"><label for="TODO1">Add support to compare specific builds, rather just new one.</label>
- <input type="checkbox" name="TODO2"><label for="TODO2">Restructure the whole project that allow to get required by other projects.</label>
- <input type="checkbox" name="TODO3"><label for="TODO3">Change all the functions and stuff to async/promise.</label>
- <input type="checkbox" name="TODO4"><label for="TODO4">Add Babel to transpile ES6 to ES5 for older Nodejs versions.</label>
- <input type="checkbox" name="TODO5"><label for="TODO5">Compare file counts and list as well (different list of files).</label>

# Prerequisite

- `Nodejs (//TODO: add version)`
- `node-gyp`
- `diff` command installed and added to `$PATH`
- `curl` command installed and added to `$PATH`
- Prefer Linux system since `storm-extract` act wired on Windows systems.

# Installation and Execution

    git clone https://github.com/jamiephan/HeroesSnapshotDiffer.git
    cd HeroesSnapshotDiffer
    npm intall
    npm start

# Configuation

**Important: Please rename `settings.template.js` to `settings.js` first, otherwise the whole project will not work.**

You can configure the `settings.js` with your account settings. This project will use both [Reddit](http://www.reddit.com) and [Ge.tt](http://ge.tt/) for posting and uploading service.

Both of these service requires an API key, you may obtain them from these locations (After login and *create/add app*):

 - https://www.reddit.com/prefs/apps/

 - http://ge.tt/developers/create

## Keys in `settings.js`

| Key                                   | Required | Type   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Example                                         |
|---------------------------------------|----------|--------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
| REDDIT_USERNAME                       | Yes      | String | The Reddit username that is going to post                                                                                                                                                                                                                                                                                                                                                                                                                                      | heroesdiff                                      |
| REDDIT_PASSWORD                       | Yes      | String | The password for the Reddit user above.                                                                                                                                                                                                                                                                                                                                                                                                                                        | S0meLove1yPswD                                  |
| REDDIT_SUBREDDIT                      | Yes      | String | The subreddit name that will be post to.                                                                                                                                                                                                                                                                                                                                                                                                                                       | heroesdiff                                      |
| REDDIT_CLIENT_ID                      | Yes      | String | The client ID from the created app: [link](https://www.reddit.com/prefs/apps/)                                                                                                                                                                                                                                                                                                                                                                                                 | p2ebKy1A9N4A7A                                  |
| REDDIT_CLIENT_SECRET                  | Yes      | String | The client Secret from the created app: [link](https://www.reddit.com/prefs/apps/)                                                                                                                                                                                                                                                                                                                                                                                             | wXg3HDCHHSUroPq-svk9jpsKoYs                     |
| REDDIT_USERAGENT                      | Yes      | String | The [UserAgent](https://en.wikipedia.org/wiki/User_agent) string that will be read by Reddit.  **Must contain useful infomation. Read more: **https://github.com/reddit-archive/reddit/wiki/API#rules                                                                                                                                                                                                                                                                          | Heroes Differ 1.0 by /u/jamiephan               |
| REDDIT_POST_TEMPLATE                  | Yes      | String | The path for the template that will be post to Reddit's content section.  The variables contains:    - {{NewBuild}} :  Build number for the latest version  - {{NewVersion}} :  version number for the latest version  - {{OldBuild}} :  Build number for the previous version  - {{OldVersion}} :  version number for the previous version  - {{diffLink}} :  The link that was uploaded to [Ge.tt](http://ge.tt/)  - {{exts}} : A description in pure for all the extensions | (See reddit-post.template)                      |
| GETT_EMAIL                            | Yes      | String | The email address for Ge.tt                                                                                                                                                                                                                                                                                                                                                                                                                                                    | heroesdiffer@gmail.com                          |
| GETT_PASSWORD                         | Yes      | String | The password for Ge.tt                                                                                                                                                                                                                                                                                                                                                                                                                                                         | SomePasswordisCool123                           |
| GETT_APIKEY                           | Yes      | String | The API key for Ge.tt. Create an app here first: [link](http://ge.tt/developers/create)                                                                                                                                                                                                                                                                                                                                                                                        | j34j5bhv23lsdfuclrx4s6sdf8sdoflnl45jbsdf0sdfjb3 |
| HEROES_OF_THE_STORM_INSTALLATION_PATH | Yes      | String | The absolute path for Heroes of the Storm                                                                                                                                                                                                                                                                                                                                                                                                                                      | /mnt/d/Program Files/Heroes of the Storm/       |
| SNAPSHOT_SAVE_PATH                    | Yes      | String | The absolute path for saving the snapshots                                                                                                                                                                                                                                                                                                                                                                                                                                     | __dirname + '/diff/'                            |
| SNAPSHOT_SAVE_PREFIX                  | Yes      | String | The prefix for snapshots when creating the directory                                                                                                                                                                                                                                                                                                                                                                                                                           | snapshot-                                       |
| SNAPSHOT_SAVE_EXTENSIONS              | Yes      | Array  | Array of extensions to filter out (use `[]` for everything)                                                                                                                                                                                                                                                                                                                                                                                                                    | ['xml', 'galaxy', 'txt', 'StormLayout']         |
| DIFF_RESULTS_FILENAME_TEMPLATE        | Yes      | String | The absolute path for the result diff file template.   The variables contains:    - {{NewBuild}} :  Build number for the latest version  - {{OldBuild}} :  Build number for the previous version                                                                                                                                                                                                                                                                               | diff_{{NewBuild}}_{{OldBuild}}.txt              |
| DIFF_RESULTS_SAVE_PATH                | Yes      | String | The absolute path for saving the diff result files.                                                                                                                                                                                                                                                                                                                                                                                                                            | __dirname + '/diff_results/                     |